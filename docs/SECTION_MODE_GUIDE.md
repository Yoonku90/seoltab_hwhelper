# 섹션별 생성 모드 가이드

## 개요

섹션별 생성 모드는 수업 STT와 이미지를 의미 있는 단위로 나누어 단계적으로 요약을 생성하는 방식입니다.

## 사용 방법

### API 호출 시 옵션 추가

```json
{
  "roomId": "69283e3394e6ccc67b06c689",
  "useSectionMode": true,  // 섹션별 생성 모드 활성화
  "testMode": true  // 테스트 모드 (선택사항)
}
```

### 섹션 분할 기준

1. **페이지 전환**: "다음 페이지", "이제 ~볼게"
2. **주제 전환**: "이제 ~해볼게", "다음으로 ~"
3. **시간 간격**: 10분 이상 공백

### 작동 방식

1. **섹션 분할**: STT를 자동으로 여러 섹션으로 분할
2. **섹션별 요약**: 각 섹션별로 별도 요약 생성
3. **통합**: 섹션 요약들을 하나로 통합

### 비용

- **현재 방식**: 1회 LLM 호출
- **섹션별 방식**: N개 섹션 + 1회 통합 = (N+1)회 호출
- **예상 비용 증가**: 약 2~3배

## 학년 자동 매칭

### 스프레드시트 파일 준비

`data/students.json` 파일을 생성하고 다음 형식으로 작성:

```json
[
  {
    "s_user_no": 348133,
    "s_user_name": "성유진",
    "year": 484,
    "grade": "N수생"
  },
  {
    "s_user_no": 365070,
    "s_user_name": "이수현",
    "year": 482,
    "grade": "고3"
  }
]
```

### 학년 자동 조회

- `studentId`가 있으면 자동으로 학년 조회
- 우선순위: body로 전달된 `grade` > 자동 매칭된 학년

### 환경 변수 설정

`.env.local`에 추가:

```bash
STUDENT_SPREADSHEET_PATH=./data/students.json
```

## 테스트

1. `useSectionMode: true`로 요약 생성
2. 콘솔에서 섹션 분할 및 생성 과정 확인
3. 결과 비교 및 품질 평가

