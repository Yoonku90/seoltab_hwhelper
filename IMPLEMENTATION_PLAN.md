# PDF 교재 학습 앱 구현 계획

## 📋 개요

PDF 교재를 업로드하면 한 장 단위로 분석하고, PDF 위에 텍스트를 오버레이하여 학생에게 가르치는 형태의 학습 앱입니다.

## ✅ 기술적 가능성

### 1. PDF 처리
- **라이브러리**: `react-pdf` 또는 `pdfjs-dist`
- **기능**: 
  - PDF 업로드 및 파싱
  - 페이지별 분리 및 렌더링
  - 텍스트 추출 (OCR 필요 시 `pdf-parse` 또는 이미지 기반 OCR)

### 2. PDF 위 텍스트 오버레이
- **방식 1**: CSS positioning (absolute)로 PDF 위에 레이어 배치
- **방식 2**: Canvas를 사용하여 PDF 위에 직접 텍스트 렌더링
- **방식 3**: `react-pdf`의 Annotation 기능 활용

### 3. AI 분석 및 설명
- **참고**: `zoom-chatbot`의 SYSTEM_PROMPT 구조
- **기능**:
  - 개념 설명 (정답 직접 제공 X, 풀이 방식만 안내)
  - 문제 풀이 힌트 제공
  - 단계별 학습 가이드

### 4. 맞춤형 문제 생성
- **참고**: `contents-generator`의 프롬프트 구조
- **기능**:
  - 학습한 개념 기반 문제 생성
  - 난이도 조절
  - 다양한 문제 유형 생성

## 🏗️ 작동 방식

### 1. PDF 업로드 및 처리
```
사용자 → PDF 업로드
  ↓
서버/클라이언트: PDF 파싱
  ↓
페이지별로 분리 (1페이지 = 1단원 개념)
  ↓
각 페이지의 텍스트 추출
```

### 2. AI 주도 자동 학습 플로우 (핵심 기능)

**"학습 시작" 버튼 클릭 시:**

```
[1단계: 학습 계획 수립]
  AI가 PDF 페이지를 분석
  → 학습 목표 설정
  → 학습 순서 결정
  → 예상 소요 시간 계산
  ↓
[2단계: 개념 설명 (자동 진행)]
  AI가 스스로 개념 설명 시작
  → PDF 위에 텍스트가 타이핑되듯 나타남
  → 핵심 개념 강조 표시
  → 단계별 설명 (자동으로 다음 단계 진행)
  → 예시 제시
  ↓
[3단계: 이해도 확인 (대화형)]
  AI가 질문 제시: "이해하셨나요?"
  → 사용자 응답 대기 또는 자동 진행
  → 이해도에 따라 추가 설명 또는 다음 단계
  ↓
[4단계: 문제 제시 및 풀이 가이드]
  페이지 내 문제 식별
  → 문제를 PDF 위에 강조 표시
  → 풀이 방식 안내 (정답 X, 단계별 힌트)
  → 학생이 직접 풀도록 유도
  → 힌트 제공 (필요 시)
  ↓
[5단계: 맞춤형 문제 생성]
  학습한 개념 기반 문제 생성
  → PDF 위에 새 문제 표시
  → 난이도 조절
  → 다양한 유형
  ↓
[6단계: 학습 정리 및 다음 페이지]
  오늘 배운 내용 정리
  → 다음 페이지로 이동 제안
  → 또는 복습 제안
```

### 3. 자동 진행 메커니즘

**AI가 주도하는 학습 흐름:**
- **스트리밍 응답**: AI의 설명이 실시간으로 PDF 위에 나타남
- **단계별 자동 진행**: 각 단계가 완료되면 자동으로 다음 단계로 이동
- **사용자 개입 지점**: 이해도 확인, 문제 풀이 등에서 사용자 응답 대기
- **동적 조절**: 사용자의 이해도에 따라 설명 속도나 난이도 조절

### 3. UI/UX 구조

```
┌─────────────────────────────────────────────┐
│  [학습 시작] 버튼 / [일시정지] / [다음]    │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  PDF 뷰어 (상단)                           │
│  [PDF 페이지 렌더링]                       │
│                                            │
│  ┌──────────────────────────────────────┐ │
│  │ [실시간 오버레이 텍스트 레이어]      │ │
│  │ - 타이핑 애니메이션으로 나타나는 설명│ │
│  │ - 핵심 개념 강조 표시                │ │
│  │ - 문제 영역 하이라이트                │ │
│  │ - 단계별 설명 표시                    │ │
│  └──────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  학습 진행 상태 표시줄                     │
│  [1. 개념 설명] → [2. 이해도 확인] → ... │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  대화형 패널 (하단, 필요 시 표시)          │
│  - AI 질문: "이해하셨나요?"                │
│  - 사용자 응답 입력                        │
│  - [이해했어요] / [다시 설명해줘] 버튼   │
└─────────────────────────────────────────────┘
```

## 📁 프로젝트 구조

```
seoltab_wanja/
├── web/
│   ├── app/
│   │   ├── page.tsx              # 메인 페이지
│   │   ├── api/
│   │   │   ├── pdf/
│   │   │   │   ├── upload/        # PDF 업로드
│   │   │   │   ├── extract/      # 텍스트 추출
│   │   │   │   └── analyze/      # 페이지 분석
│   │   │   ├── chat/             # AI 튜터 채팅
│   │   │   └── generate/         # 문제 생성
│   │   └── learn/
│   │       └── [pageId]/
│   │           └── page.tsx      # 페이지별 학습 화면
│   ├── components/
│   │   ├── PdfViewer.tsx         # PDF 뷰어
│   │   ├── OverlayText.tsx       # 오버레이 텍스트
│   │   ├── ChatPanel.tsx         # 채팅 패널
│   │   └── ProblemGenerator.tsx # 문제 생성 UI
│   └── lib/
│       ├── pdf.ts                # PDF 처리 유틸
│       ├── prompts.ts            # AI 프롬프트
│       └── chat.ts               # 채팅 로직
└── package.json
```

## 🔧 필요한 기술 스택

### 프론트엔드
- `react-pdf` 또는 `pdfjs-dist`: PDF 렌더링
- `@google/generative-ai`: AI 분석 및 문제 생성
- `next`: 프레임워크
- `typescript`: 타입 안정성

### 백엔드 (API Routes)
- PDF 텍스트 추출
- AI 분석 API
- 문제 생성 API

## 🎯 주요 기능

### 1. PDF 업로드 및 페이지 분리
- [ ] PDF 파일 업로드
- [ ] 페이지별 분리
- [ ] 텍스트 추출 (OCR 포함)

### 2. AI 주도 자동 학습 시스템 (핵심)
- [ ] 학습 계획 수립 (AI가 자동으로)
- [ ] 단계별 자동 진행 로직
- [ ] 학습 상태 관리 (concept_explanation, question_check, problem_solving 등)
- [ ] 동적 학습 흐름 제어

### 3. 실시간 스트리밍 설명
- [ ] AI 응답 스트리밍 (zoom-chatbot 방식 참고)
- [ ] PDF 위에 타이핑 애니메이션으로 텍스트 표시
- [ ] 핵심 개념 강조 표시
- [ ] 단계별 설명 자동 진행

### 4. 대화형 이해도 확인
- [ ] AI가 질문 제시
- [ ] 사용자 응답 대기
- [ ] 이해도에 따른 추가 설명 또는 다음 단계

### 5. 문제 풀이 가이드 (자동 진행)
- [ ] 페이지 내 문제 자동 식별
- [ ] 문제 영역 하이라이트
- [ ] 풀이 방식 단계별 안내 (정답 X)
- [ ] 힌트 제공 (필요 시)

### 6. 맞춤형 문제 생성 (자동)
- [ ] 학습 개념 기반 문제 자동 생성
- [ ] 난이도 조절
- [ ] 다양한 유형
- [ ] PDF 위에 새 문제 표시

### 7. 학습 진행 상태 표시
- [ ] 현재 학습 단계 표시
- [ ] 진행률 표시
- [ ] 일시정지/재개 기능

## 📝 다음 단계

1. 프로젝트 초기 설정 (Next.js + TypeScript) ✅
2. PDF 업로드 및 렌더링 구현
3. AI 주도 학습 시스템 설계
   - 학습 상태 관리 시스템
   - 단계별 자동 진행 로직
   - AI 프롬프트 설계 (학습 계획 수립, 개념 설명, 문제 제시 등)
4. 실시간 스트리밍 설명 구현
   - 스트리밍 API 연동
   - PDF 위 타이핑 애니메이션
   - 오버레이 텍스트 시스템
5. 대화형 이해도 확인 구현
6. 문제 풀이 가이드 (자동 진행) 구현
7. 맞춤형 문제 생성 (자동) 구현
8. 학습 진행 상태 UI 구현

## 🔑 핵심 기술 요구사항

### 1. 학습 상태 관리
```typescript
type LearningState = 
  | 'idle'                    // 대기 중
  | 'planning'                // 학습 계획 수립 중
  | 'explaining_concept'      // 개념 설명 중
  | 'checking_understanding'  // 이해도 확인 중
  | 'solving_problem'         // 문제 풀이 중
  | 'generating_problem'      // 문제 생성 중
  | 'reviewing'               // 복습 중
  | 'completed'               // 완료
```

### 2. AI 프롬프트 구조
- **학습 계획 수립 프롬프트**: PDF 분석 → 학습 순서 결정
- **개념 설명 프롬프트**: 단계별 설명, PDF 위 표시 위치 지정
- **이해도 확인 프롬프트**: 질문 생성, 응답 평가
- **문제 풀이 가이드 프롬프트**: 힌트 제공, 정답 X
- **문제 생성 프롬프트**: 맞춤형 문제 생성

### 3. 스트리밍 응답 처리
- AI 응답을 실시간으로 받아서 PDF 위에 표시
- 타이핑 애니메이션 효과
- 단계별 구분 (개념 설명 → 문제 제시 등)

